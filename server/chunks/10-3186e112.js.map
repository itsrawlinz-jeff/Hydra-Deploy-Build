{"version":3,"file":"10-3186e112.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/settings/_page.server.ts.js","../../../.svelte-kit/adapter-node/nodes/10.js"],"sourcesContent":["import { b as base } from \"../../../chunks/paths.js\";\nimport { c as collections } from \"../../../chunks/database.js\";\nimport { r as redirect } from \"../../../chunks/index.js\";\nimport { z } from \"zod\";\nimport { v as validateModel, m as models } from \"../../../chunks/models.js\";\nimport { a as authCondition } from \"../../../chunks/auth.js\";\nimport { D as DEFAULT_SETTINGS } from \"../../../chunks/Settings.js\";\nconst booleanFormObject = z.union([z.literal(\"true\"), z.literal(\"on\"), z.literal(\"false\"), z.null()]).transform((value) => {\n  return value === \"true\" || value === \"on\";\n});\nconst actions = {\n  default: async function({ request, locals }) {\n    const formData = await request.formData();\n    const { ethicsModalAccepted, ...settings } = z.object({\n      shareConversationsWithModelAuthors: booleanFormObject,\n      hideEmojiOnSidebar: booleanFormObject,\n      ethicsModalAccepted: z.boolean({ coerce: true }).optional(),\n      activeModel: validateModel(models),\n      customPrompts: z.record(z.string()).default({})\n    }).parse({\n      hideEmojiOnSidebar: formData.get(\"hideEmojiOnSidebar\"),\n      shareConversationsWithModelAuthors: formData.get(\"shareConversationsWithModelAuthors\"),\n      ethicsModalAccepted: formData.get(\"ethicsModalAccepted\"),\n      activeModel: formData.get(\"activeModel\") ?? DEFAULT_SETTINGS.activeModel,\n      customPrompts: JSON.parse(formData.get(\"customPrompts\")?.toString() ?? \"{}\")\n    });\n    await collections.settings.updateOne(\n      authCondition(locals),\n      {\n        $set: {\n          ...settings,\n          ...ethicsModalAccepted && { ethicsModalAcceptedAt: /* @__PURE__ */ new Date() },\n          updatedAt: /* @__PURE__ */ new Date()\n        },\n        $setOnInsert: {\n          createdAt: /* @__PURE__ */ new Date()\n        }\n      },\n      {\n        upsert: true\n      }\n    );\n    throw redirect(303, request.headers.get(\"referer\") || `${base}/`);\n  }\n};\nexport {\n  actions\n};\n","import * as server from '../entries/pages/settings/_page.server.ts.js';\n\nexport const index = 10;\nexport { server };\nexport const server_id = \"src/routes/settings/+page.server.ts\";\nexport const imports = [];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAOA,MAAM,iBAAiB,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,KAAK,KAAK;AAC3H,EAAE,OAAO,KAAK,KAAK,MAAM,IAAI,KAAK,KAAK,IAAI,CAAC;AAC5C,CAAC,CAAC,CAAC;AACH,MAAM,OAAO,GAAG;AAChB,EAAE,OAAO,EAAE,eAAe,EAAE,OAAO,EAAE,MAAM,EAAE,EAAE;AAC/C,IAAI,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,QAAQ,EAAE,CAAC;AAC9C,IAAI,MAAM,EAAE,mBAAmB,EAAE,GAAG,QAAQ,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC;AAC1D,MAAM,kCAAkC,EAAE,iBAAiB;AAC3D,MAAM,kBAAkB,EAAE,iBAAiB;AAC3C,MAAM,mBAAmB,EAAE,CAAC,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,QAAQ,EAAE;AACjE,MAAM,WAAW,EAAE,aAAa,CAAC,MAAM,CAAC;AACxC,MAAM,aAAa,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;AACrD,KAAK,CAAC,CAAC,KAAK,CAAC;AACb,MAAM,kBAAkB,EAAE,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC;AAC5D,MAAM,kCAAkC,EAAE,QAAQ,CAAC,GAAG,CAAC,oCAAoC,CAAC;AAC5F,MAAM,mBAAmB,EAAE,QAAQ,CAAC,GAAG,CAAC,qBAAqB,CAAC;AAC9D,MAAM,WAAW,EAAE,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,gBAAgB,CAAC,WAAW;AAC9E,MAAM,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC,EAAE,QAAQ,EAAE,IAAI,IAAI,CAAC;AAClF,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,WAAW,CAAC,QAAQ,CAAC,SAAS;AACxC,MAAM,aAAa,CAAC,MAAM,CAAC;AAC3B,MAAM;AACN,QAAQ,IAAI,EAAE;AACd,UAAU,GAAG,QAAQ;AACrB,UAAU,GAAG,mBAAmB,IAAI,EAAE,qBAAqB,kBAAkB,IAAI,IAAI,EAAE,EAAE;AACzF,UAAU,SAAS,kBAAkB,IAAI,IAAI,EAAE;AAC/C,SAAS;AACT,QAAQ,YAAY,EAAE;AACtB,UAAU,SAAS,kBAAkB,IAAI,IAAI,EAAE;AAC/C,SAAS;AACT,OAAO;AACP,MAAM;AACN,QAAQ,MAAM,EAAE,IAAI;AACpB,OAAO;AACP,KAAK,CAAC;AACN,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AACtE,GAAG;AACH,CAAC;;;;;;;AC1CW,MAAC,KAAK,GAAG,GAAG;AAEZ,MAAC,SAAS,GAAG,sCAAsC;AACnD,MAAC,OAAO,GAAG,GAAG;AACd,MAAC,WAAW,GAAG,GAAG;AAClB,MAAC,KAAK,GAAG;;;;"}